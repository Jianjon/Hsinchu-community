
import * as fs from 'fs';
import * as path from 'path';

// --- Helper: Map Link ---
const getMapLink = (name: string, address: string) =>
    `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(name + ' ' + address)}`;

// --- Zip to Township Mapping ---
const ZIP_MAP: Record<string, string> = {
    "302": "竹北市",
    "303": "湖口鄉",
    "304": "新豐鄉",
    "305": "新埔鎮",
    "306": "關西鎮",
    "307": "芎林鄉",
    "308": "寶山鄉",
    "310": "竹東鎮",
    "311": "五峰鄉",
    "312": "橫山鄉",
    "313": "尖石鄉",
    "314": "北埔鄉",
    "315": "峨眉鄉"
};

const RAW_DATA = [
    {
        "主題分類": "教育與進修",
        "名稱": "新竹縣立竹北國民中學",
        "郵遞區號": "302",
        "住址": "新竹縣竹北市中正西路154號",
        "電話": "(03)5552064"
    },
    { "主題分類": "教育與進修", "名稱": "新竹縣立鳳岡國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市鳳岡路三段100號", "電話": "(03)5561284" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立六家高級中學(國中部)", "郵遞區號": "302", "住址": "新竹縣竹北市嘉興路356號", "電話": "(03)5503824" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立博愛國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市縣政十三路81號", "電話": "(03)5530243" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立仁愛國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市三民路239號", "電話": "(03)5530238" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立成功國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市成功八路99號", "電話": "(03)5505924" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立東興國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市嘉豐六路1段101號", "電話": "(03)5506881" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立勝利國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市智慧一路101號", "電話": "(03)6561113" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立文興國民中學", "郵遞區號": "302", "住址": "新竹縣竹北市興隆路五段461號", "電話": "(03)6586311" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立新豐國民中學", "郵遞區號": "304", "住址": "新竹縣新豐鄉重興村成德街36號", "電話": "(03)5596573" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立忠孝國民中學", "郵遞區號": "304", "住址": "新竹縣新豐鄉孝六街1號", "電話": "(03)5572555" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立精華國民中學", "郵遞區號": "304", "住址": "新竹縣新豐鄉後湖村8鄰166號", "電話": "(03)5689491" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立湖口高級中學(國中部)", "郵遞區號": "303", "住址": "新竹縣湖口鄉中正路二段263巷21號", "電話": "(03)5690772" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立新湖國民中學", "郵遞區號": "303", "住址": "新竹縣湖口鄉新湖路200號", "電話": "(03)5992159" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立中正國民中學", "郵遞區號": "303", "住址": "新竹縣湖口鄉仁興路135號", "電話": "(03)5981067" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立新埔國民中學", "郵遞區號": "305", "住址": "新竹縣新埔鎮中正路792號", "電話": "(03)5882026" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立照門國民中學", "郵遞區號": "305", "住址": "新竹縣新埔鎮照門里照鏡7號", "電話": "(03)5890214" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立北平華德福實驗學校(國中部)", "郵遞區號": "305", "住址": "新竹縣新埔鎮北平里8鄰62號", "電話": "(03)5882897" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立關西國民中學", "郵遞區號": "306", "住址": "新竹縣關西鎮北斗里北門口41號", "電話": "(03)5872008" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立石光國民中學", "郵遞區號": "307", "住址": "新竹縣關西鎮石光里308巷44號", "電話": "(03)5868019" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立富光國民中學", "郵遞區號": "306", "住址": "新竹縣關西鎮東光里十六張49號", "電話": "(03)5872224" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立芎林國民中學", "郵遞區號": "307", "住址": "新竹縣芎林鄉新鳳村74號", "電話": "(03)5922775" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立竹東國民中學", "郵遞區號": "310", "住址": "新竹縣竹東鎮公園路8號", "電話": "(03)5961207" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立二重國民中學", "郵遞區號": "310", "住址": "新竹縣竹東鎮二重里學府路132號", "電話": "(03)5823083" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立員東國民中學", "郵遞區號": "310", "住址": "新竹縣竹東鎮東峰路521號", "電話": "(03)5963324" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立自強國民中學", "郵遞區號": "310", "住址": "新竹縣竹東鎮自強路169號", "電話": "(03)5103291" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立寶山國民中學", "郵遞區號": "308", "住址": "新竹縣寶山鄉三峰路二段600號", "電話": "(03)5202104" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立寶山國民中學莒光分部", "郵遞區號": "308", "住址": "新竹縣寶山鄉新湖路一段386號", "電話": "(03)5761278" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立橫山國民中學", "郵遞區號": "312", "住址": "新竹縣橫山鄉中豐路二段415號", "電話": "(03)5931665" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立華山國民中學", "郵遞區號": "312", "住址": "新竹縣橫山鄉橫山街1段\n29號", "電話": "(03)5934084" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立北埔國民中學", "郵遞區號": "314", "住址": "新竹縣北埔鄉埔尾村埔心街141號", "電話": "(03)5802224" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立峨眉國民中學", "郵遞區號": "315", "住址": "新竹縣峨眉鄉峨眉街54號 ", "電話": "(03)5800208" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立五峰國民中學", "郵遞區號": "311", "住址": "新竹縣五峰鄉大隘村6鄰113號", "電話": "(03)5851006" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立尖石國民中學", "郵遞區號": "313", "住址": "新竹縣尖石鄉嘉樂村3鄰80號", "電話": "(03)5841027" },
    { "主題分類": "教育與進修", "名稱": "私立義民高級中學附設國中部", "郵遞區號": "302", "住址": "新竹縣竹北市中正西路15號", "電話": "(03)5552020" },
    { "主題分類": "教育與進修", "名稱": "新竹縣私立康乃薾國民中小學\n(國中部)", "郵遞區號": "302", "住址": "新竹縣竹北市六家一路二段115號", "電話": "(03)6589188" },
    { "主題分類": "教育與進修", "名稱": "新竹縣私立忠信學校\n(國中部)", "郵遞區號": "304", "住址": "新竹縣新豐鄉忠信街178號", "電話": "(03)5595775" },
    { "主題分類": "教育與進修", "名稱": "新竹縣仰德高級中學\n附設國中部", "郵遞區號": "304", "住址": "新竹縣新豐鄉員山村133號", "電話": "(03)559-2158" },
    { "主題分類": "教育與進修", "名稱": "內思學校財團法人新竹縣內思工業高級中等學校\n附設國中部", "郵遞區號": "305", "住址": "新竹縣新埔鎮楊新路一段40號", "電話": "(03)5882520" },
    { "主題分類": "教育與進修", "名稱": "臺灣新竹縣私立東泰高級中學\n附設國中部", "郵遞區號": "310", "住址": "新竹縣竹東鎮東峰路343號", "電話": "(03)5961232" },
    { "主題分類": "教育與進修", "名稱": "國立新竹特殊教育學校(國中部)", "郵遞區號": "302", "住址": "新竹縣竹北市光明六路東二段201號", "電話": "(03)6676639" },
    { "主題分類": "教育與進修", "名稱": "誠正中學\n(國中部)", "郵遞區號": "304", "住址": "新竹縣新豐鄉松柏村20鄰德昌街231號", "電話": "(03)5575054" },
    { "主題分類": "教育與進修", "名稱": "竹北國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市中央路98號", "電話": "(03)5552047" },
    { "主題分類": "教育與進修", "名稱": "中正國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市中山路190號", "電話": "(03)5552464" },
    { "主題分類": "教育與進修", "名稱": "竹仁國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市仁和街1號", "電話": "(03)5552472" },
    { "主題分類": "教育與進修", "名稱": "新社國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市新社里\n25鄰40號", "電話": "(03)5552026" },
    { "主題分類": "教育與進修", "名稱": "六家國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市嘉興路62號", "電話": "(03)5502624" },
    { "主題分類": "教育與進修", "名稱": "東海國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市東興路一段839號", "電話": "(03)5502961" },
    { "主題分類": "教育與進修", "名稱": "豐田國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市中正西路1377號", "電話": "(03)5563930" },
    { "主題分類": "教育與進修", "名稱": "麻園國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市長園一街236號", "電話": "(03)5563540" },
    { "主題分類": "教育與進修", "名稱": "新港國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市長青路一段333巷135號", "電話": "(03)5563275" },
    { "主題分類": "教育與進修", "名稱": "鳳岡國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市鳳岡路三段200號", "電話": "(03)5561928" },
    { "主題分類": "教育與進修", "名稱": "博愛國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市光明六路72號", "電話": "(03)5519830" },
    { "主題分類": "教育與進修", "名稱": "光明國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市光明九路65號", "電話": "(03)5538655" },
    { "主題分類": "教育與進修", "名稱": "十興國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市莊敬北路66號", "電話": "(03)6583517" },
    { "主題分類": "教育與進修", "名稱": "東興國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市嘉豐十一路二段100號", "電話": "(03)5502120" },
    { "主題分類": "教育與進修", "名稱": "興隆國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市文興路88號", "電話": "(03)6681799" },
    { "主題分類": "教育與進修", "名稱": "安興國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市十興路一段435號", "電話": "(03)6684105" },
    { "主題分類": "教育與進修", "名稱": "嘉豐國民小學", "郵遞區號": "302", "住址": "新竹縣竹北市嘉豐五路一段59號", "電話": "(03)6672361" },
    { "主題分類": "教育與進修", "名稱": "文興國民小學籌備處", "郵遞區號": "314", "住址": "新竹縣北埔鄉埔新街24號", "電話": "(03)5802215" },
    { "主題分類": "教育與進修", "名稱": "新豐國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉重興村明德巷13號 ", "電話": "(03)5592081" },
    { "主題分類": "教育與進修", "名稱": "福興國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉後湖村後湖子108號", "電話": "(03)5680964" },
    { "主題分類": "教育與進修", "名稱": "埔和國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉埔和村466號", "電話": "(03)5680096" },
    { "主題分類": "教育與進修", "名稱": "瑞興國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉瑞興村4鄰崁頭63號", "電話": "(03)5680490" },
    { "主題分類": "教育與進修", "名稱": "福龍國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉福興村113號", "電話": "(03)5993140" },
    { "主題分類": "教育與進修", "名稱": "松林國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉松林村松林街99號", "電話": "(03)5573601" },
    { "主題分類": "教育與進修", "名稱": "山崎國民小學", "郵遞區號": "304", "住址": "新竹縣新豐鄉新興路291號", "電話": "(03)5592714" },
    { "主題分類": "教育與進修", "名稱": "新湖國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉民族街222號", "電話": "(03)5992062" },
    { "主題分類": "教育與進修", "名稱": "和興國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉德興路930號", "電話": "(03)5992094" },
    { "主題分類": "教育與進修", "名稱": "信勢國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉成功路360號", "電話": "(03)5992133" },
    { "主題分類": "教育與進修", "名稱": "湖口國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉湖口村3鄰八德路二段182號", "電話": "(03)5693108" },
    { "主題分類": "教育與進修", "名稱": "長安國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉長安村長春路50號", "電話": "(03)5690596" },
    { "主題分類": "教育與進修", "名稱": "中興國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉勝利村吉祥街43號 ", "電話": "(03)5982043" },
    { "主題分類": "教育與進修", "名稱": "華興國民小學", "郵遞區號": "303", "住址": "新竹縣湖口鄉文化路171號", "電話": "(03)5981789" },
    { "主題分類": "教育與進修", "名稱": "新埔國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮中正路366號", "電話": "(03)5882124" },
    { "主題分類": "教育與進修", "名稱": "新星國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮民生街28號", "電話": "(03)5882078" },
    { "主題分類": "教育與進修", "名稱": "照門國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮照門里9鄰照鏡39號", "電話": "(03)5899234" },
    { "主題分類": "教育與進修", "名稱": "清水國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮清水里143號", "電話": "(03)5899235" },
    { "主題分類": "教育與進修", "名稱": "照東國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮鹿鳴里36號", "電話": "(03)5899807" },
    { "主題分類": "教育與進修", "名稱": "枋寮國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮上寮里義民路二段350號", "電話": "(03)5882081" },
    { "主題分類": "教育與進修", "名稱": "寶石國民小學", "郵遞區號": "305", "住址": "新埔鎮寶石里9鄰關埔路內立段672號", "電話": "(03)5882397" },
    { "主題分類": "教育與進修", "名稱": "文山國民小學", "郵遞區號": "305", "住址": "新竹縣新埔鎮國校街160號", "電話": "(03)5882918" },
    { "主題分類": "教育與進修", "名稱": "新竹縣立北平華德福實驗學校(國小部)", "郵遞區號": "305", "住址": "新竹縣新埔鎮北平里8鄰62號", "電話": "(03)5882897" },
    { "主題分類": "教育與進修", "名稱": "關西國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮西安里中山路126號", "電話": "(03)5872028" },
    { "主題分類": "教育與進修", "名稱": "東安國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮中山東路40號", "電話": "(03)5872177" },
    { "主題分類": "教育與進修", "名稱": "石光國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮石光里石岡子路386號", "電話": "(03)5869311" },
    { "主題分類": "教育與進修", "名稱": "坪林國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮上林里11鄰11號", "電話": "(03)5869310" },
    { "主題分類": "教育與進修", "名稱": "南和國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮南和里6鄰69號", "電話": "(03)5868952" },
    { "主題分類": "教育與進修", "名稱": "太平國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮東平里5鄰27號", "電話": "(03)5882634" },
    { "主題分類": "教育與進修", "名稱": "東光國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮東光里5鄰十六張190號", "電話": "(03)5872243" },
    { "主題分類": "教育與進修", "名稱": "錦山國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮金山里107號", "電話": "(03)5478681" },
    { "主題分類": "教育與進修", "名稱": "玉山國民小學", "郵遞區號": "306", "住址": "新竹縣關西鎮玉山里4鄰25號", "電話": "(03)5476349" },
    { "主題分類": "教育與進修", "名稱": "芎林國民小學", "郵遞區號": "307", "住址": "新竹縣芎林鄉文山路288號", "電話": "(03)5923184" },
    { "主題分類": "教育與進修", "名稱": "碧潭國民小學", "郵遞區號": "307", "住址": "新竹縣芎林鄉石潭村福昌街90號", "電話": "(03)5923191" },
    { "主題分類": "教育與進修", "名稱": "五龍國民小學", "郵遞區號": "307", "住址": "新竹縣芎林鄉五龍村105號", "電話": "(03)5932320" },
    { "主題分類": "教育與進修", "名稱": "竹東國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮康寧街1號", "電話": "(03)5962025" },
    { "主題分類": "教育與進修", "名稱": "大同國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮莊敬路111號", "電話": "(03)5961160" },
    { "主題分類": "教育與進修", "名稱": "陸豐國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮陸豐里4鄰48號", "電話": "(03)5923697" },
    { "主題分類": "教育與進修", "名稱": "中山國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮中山路70號", "電話": "(03)5962102" },
    { "主題分類": "教育與進修", "名稱": "員崠國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮東峰路281號", "電話": "(03)5962143" },
    { "主題分類": "教育與進修", "名稱": "二重國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮光明路32號", "電話": "(03)5822098" },
    { "主題分類": "教育與進修", "名稱": "竹中國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮頭重里竹中路104巷14號", "電話": "(03)5823822" },
    { "主題分類": "教育與進修", "名稱": "瑞峰國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮上坪里4鄰43號", "電話": "(03)5949052" },
    { "主題分類": "教育與進修", "名稱": "上舘國民小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮中豐路二段399號", "電話": "(03)5103777" },
    { "主題分類": "教育與進修", "名稱": "寶山國民小學", "郵遞區號": "308", "住址": "新竹縣寶山鄉寶山村寶山路2段130號", "電話": "(03)5761390" },
    { "主題分類": "教育與進修", "名稱": "寶山國民小學山湖分校", "郵遞區號": "308", "住址": "新竹縣寶山鄉山湖村山湖路420號", "電話": "(03)5761215" },
    { "主題分類": "教育與進修", "名稱": "新城國民小學", "郵遞區號": "308", "住址": "新竹縣寶山鄉寶新路二段475號", "電話": "(03)5762707" },
    { "主題分類": "教育與進修", "名稱": "雙溪國民小學", "郵遞區號": "308", "住址": "新竹縣寶山鄉雙園路2段310號", "電話": "(03)5202151" },
    { "主題分類": "教育與進修", "名稱": "橫山國民小學", "郵遞區號": "312", "住址": "新竹縣橫山鄉橫山村五鄰100號", "電話": "(03)5933780" },
    { "主題分類": "教育與進修", "名稱": "田寮國民小學", "郵遞區號": "312", "住址": "新竹縣橫山鄉田寮村田洋街128號", "電話": "(03)5934164" },
    { "主題分類": "教育與進修", "名稱": "大肚國民小學", "郵遞區號": "312", "住址": "新竹縣橫山鄉中豐路二段157號", "電話": "(03)5932380" },
    { "主題分類": "教育與進修", "名稱": "沙坑國民小學", "郵遞區號": "312", "住址": "新竹縣橫山鄉沙村沙坑街48號", "電話": "(03)5811034" },
    { "主題分類": "教育與進修", "名稱": "內灣國民小學", "郵遞區號": "312", "住址": "新竹縣橫山鄉內灣村3鄰110號", "電話": "(03)5848019" },
    { "主題分類": "教育與進修", "名稱": "北埔國民小學", "郵遞區號": "314", "住址": "新竹縣北埔鄉埔心街24號", "電話": "(03)5802215" },
    { "主題分類": "教育與進修", "名稱": "大坪國民小學", "郵遞區號": "314", "住址": "新竹縣北埔鄉外坪村1鄰外大坪8號", "電話": "(03)5802264" },
    { "主題分類": "教育與進修", "名稱": "峨眉國民小學", "郵遞區號": "315", "住址": "新竹縣峨眉鄉峨眉村峨眉街4號", "電話": "(03)5800674" },
    { "主題分類": "教育與進修", "名稱": "富興國民小學", "郵遞區號": "315", "住址": "新竹縣峨眉鄉富興村太平街8號", "電話": "(03)5806353" },
    { "主題分類": "教育與進修", "名稱": "尖石國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉嘉樂村6鄰7號", "電話": "(03)5841563" },
    { "主題分類": "教育與進修", "名稱": "嘉興國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉嘉樂村三鄰177號", "電話": "(03)5841004" },
    { "主題分類": "教育與進修", "名稱": "嘉興國民小學義興分校", "郵遞區號": "313", "住址": "新竹縣尖石鄉義興村馬胎8鄰51號", "電話": "(03)5841600" },
    { "主題分類": "教育與進修", "名稱": "新樂國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉新樂村1鄰10號", "電話": "(03)5841500" },
    { "主題分類": "教育與進修", "名稱": "梅花國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉梅花村1鄰25號", "電話": "(03)5841501" },
    { "主題分類": "教育與進修", "名稱": "錦屏國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉錦屏村10鄰116號", "電話": "(03)5841633" },
    { "主題分類": "教育與進修", "名稱": "玉峰國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉玉峰村5鄰59號", "電話": "(03)5847200" },
    { "主題分類": "教育與進修", "名稱": "石磊國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉玉峰村10鄰49號", "電話": "(03)5847001" },
    { "主題分類": "教育與進修", "名稱": "秀巒國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉秀巒村4鄰19號", "電話": "(03)5847500" },
    { "主題分類": "教育與進修", "名稱": "秀巒國民小學田埔分校", "郵遞區號": "313", "住址": "新竹縣尖石鄉秀巒村田埔1鄰5號", "電話": "(03)5847823" },
    { "主題分類": "教育與進修", "名稱": "新光國民小學", "郵遞區號": "313", "住址": "新竹縣尖石鄉秀巒村8鄰17號", "電話": "(03)5847706" },
    { "主題分類": "教育與進修", "名稱": "五峰國民小學", "郵遞區號": "311", "住址": "新竹縣五峰鄉大隘村6鄰123號", "電話": "(03)5851007" },
    { "主題分類": "教育與進修", "名稱": "花園國民小學", "郵遞區號": "311", "住址": "新竹縣五峰鄉花園村8鄰174號", "電話": "(03)5851091" },
    { "主題分類": "教育與進修", "名稱": "花園國民小學竹林分校", "郵遞區號": "311", "住址": "新竹縣五峰鄉竹林村1鄰羅山15號", "電話": "(03)5851254" },
    { "主題分類": "教育與進修", "名稱": "桃山國民小學", "郵遞區號": "311", "住址": "新竹縣五峰鄉桃山村15鄰243號", "電話": "(03)5856040" },
    { "主題分類": "教育與進修", "名稱": "新竹縣私立康乃薾國民中小學(國小部)", "郵遞區號": "302", "住址": "新竹縣竹北市六家一路二段115號", "電話": "(03)6589188" },
    { "主題分類": "教育與進修", "名稱": "新竹縣私立上智小學", "郵遞區號": "310", "住址": "新竹縣竹東鎮東寧路三段205號", "電話": "(03)5962082" },
    { "主題分類": "教育與進修", "名稱": "國立新竹特殊教育學校(國小部)", "郵遞區號": "302", "住址": "新竹縣竹北市光明六路東二段201號", "電話": "(03)6676639" }
];

function enrichHsinchuSchools() {
    console.log('🏫 Starting Hsinchu County Schools Data Enrichment...');
    let addedCount = 0;

    // Group By Township
    const grouped: Record<string, typeof RAW_DATA> = {};

    RAW_DATA.forEach(school => {
        const township = ZIP_MAP[school["郵遞區號"]];
        if (!township) return;
        if (!grouped[township]) grouped[township] = [];
        grouped[township].push(school);
    });

    for (const [township, schools] of Object.entries(grouped)) {
        console.log(`Processing ${township}...`);
        const districtDir = path.resolve(process.cwd(), 'data/local_db/新竹縣', township);

        if (!fs.existsSync(districtDir)) {
            console.warn(`⚠️ District directory not found: ${districtDir}`);
            continue;
        }

        const villages = fs.readdirSync(districtDir).filter(f => !f.startsWith('.'));

        schools.forEach(school => {
            // Find Village
            let targetVillage = '';

            // Standardize Name for Comparison (Remove "國民", "新竹縣立", etc. and newlines)
            const getStdName = (n: string) => n
                .replace(/\s+/g, '')
                .replace(/國民中學/g, '國中')
                .replace(/國民小學/g, '國小')
                .replace(/國民中小學/g, '國中小')
                .replace(/新竹縣立/g, '')
                .replace(/私立/g, '')
                .replace(/國立/g, '')
                .replace(/高級中學\(國中部\)/g, '國中')
                .replace(/高級中等學校\(國中部\)/g, '國中')
                .replace(/附設國中部/g, '國中')
                .trim();
            const schoolName = school["名稱"].replace(/\s+/g, ''); // Remove newlines in name
            const schoolStdName = getStdName(schoolName);

            // 0. Explicit Overrides for tricky schools (Use standardized names)
            const overrides: Record<string, string> = {
                '博愛國小': '北崙里',
                '博愛國中': '北崙里',
                '竹北國中': '新社里',
                '仁愛國中': '竹北里',
                '成功國中': '鹿場里',
                '勝利國中': '十興里',
                '文興國中': '隘口里',
                '光明國小': '斗崙里',
                '十興國小': '十興里',
                '安興國小': '十興里',
                '興隆國小': '鹿場里',
                '東興國小': '隘口里',
                '嘉豐國小': '東平里',
                '竹北國小': '竹北里',
                '竹仁國小': '竹仁里',
                '新社國小': '新社里',
                '六家國小': '東平里',
                '康乃薾國中小': '東平里',
                '特殊教育學校': '十興里',
                '義民高中': '竹北里',
                '中正國小': '竹北里',
                '六家高中': '東平里',
                '鳳岡國中': '鳳岡里', // Note: Check if 鳳岡里 exist
                '鳳岡國小': '鳳岡里',
                '新豐國中': '重興村',
                '忠孝國中': '松林村',
                '新湖國中': '湖口村',
                '石光國中': '石光里',
                '橫山國中': '橫山村',
                '華興國小': '中興里',
            };
            if (overrides[schoolStdName]) targetVillage = overrides[schoolStdName];

            // 1. Check address for '里' or '村'
            if (!targetVillage) {
                for (const v of villages) {
                    if (school["住址"].includes(v)) {
                        targetVillage = v;
                        break;
                    }
                }
            }

            // 2. Fallback: Fuzzy Text Match in Name
            if (!targetVillage) {
                for (const v of villages) {
                    const shortName = v.replace(/[里村]/g, '');
                    if (schoolName.includes(shortName)) {
                        targetVillage = v;
                        break;
                    }
                }
            }

            if (targetVillage) {
                const wikiPath = path.join(districtDir, targetVillage, 'wiki.json');
                if (fs.existsSync(wikiPath)) {
                    try {
                        const content = JSON.parse(fs.readFileSync(wikiPath, 'utf-8'));
                        if (!content.facilities) content.facilities = [];

                        // Check Duplicates with Standardized Name
                        const isDuplicate = content.facilities.some((f: any) =>
                            getStdName(f.name) === schoolStdName
                        );

                        if (!isDuplicate) {
                            content.facilities.push({
                                id: `fac-${Date.now()}-${Math.floor(Math.random() * 10000)}`,
                                name: school['名稱'].replace(/\n/g, ' '),
                                type: '學校',
                                address: school['住址'].replace(/\n/g, ' '),
                                googleMapUrl: getMapLink(school['名稱'], school['住址']),
                                description: `${school['名稱'].replace(/\n/g, ' ')} 是一所位於${township}${targetVillage}的優質學校，致力於提供良好的教育環境。`,
                                tags: ['教育', '學校']
                            });
                            fs.writeFileSync(wikiPath, JSON.stringify(content, null, 2));
                            addedCount++;
                        }
                    } catch (e) {
                        console.error(`Error writing ${wikiPath}`, e);
                    }
                }
            }
            else {
                console.log(`   ? Could not map village for ${school['名稱']} (${school['住址']})`);
            }
        });
    }

    console.log(`✅ Finished. Added ${addedCount} schools.`);
}

enrichHsinchuSchools();
